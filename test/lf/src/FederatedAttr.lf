target uC {
  platform: Native,
  timeout: 1 msec
}

reactor Src(id: int = 0) {
  output out: int
  reaction(startup) -> out{=
    printf("Hello from Src!\n");
    lf_set(out, self->id);
  =}
}

reactor Dst {
  input in: int
  reaction(startup) {=
    printf("Hello from Dst!\n");
  =}
  reaction(in) {=
    printf("Received %d from Src\n", in->value);
  =}
}

federated reactor {

  @interface(type="TcpIp", name="if1", address="192.168.0.1")
  // MyNetChan_ctor(MyNetChan* self);
  r1 = new Src(id=42)

  @interface(type="TcpIp", name="if1", address="192.168.0.1")
  // MyNetChan_ctor(MyNetChan* self);
  r2 = new [10] Dst()

  @link(if_left=1, if_right=1, server_side="left", server_port=42)  
  r1.out -> r2.in 
}